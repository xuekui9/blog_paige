---
title: Git与Github交互
author: Xue Kui
date: '2022-10-07'
slug: git-github
categories:
  - R
tags:
  - Git
description: ''
keywords: []
link: ''
---



<div id="git版本控制" class="section level3">
<h3>GIT版本控制</h3>
<p><a href="https://git-scm.com/downloads">Git download webpage</a></p>
<p>默认选项安装后，输入以下命令完成最后一步</p>
<pre class="markdown"><code>git config --global user.name &quot;Your Name&quot;
git config --global user.email &quot;email@example.com&quot;

# check your settings
git config user.name
git config user.email</code></pre>
<ul>
<li>cd (Change directory)<br />
如果路径名称存在空格，需使用单引号，比如：c:/‘Git Repository’/test</li>
<li><code>cd ..</code> (Return to the previous dir)</li>
<li><code>cd myfile</code> (Set a sub-dir ‘myfile’ as new dir based on the current dir)</li>
<li><code>pwd</code> (Print wd)</li>
<li>mkdir, 即新建一个目录（文件夹），如，<code>mkdir A</code>，新建一个文件夹A.</li>
<li><code>ls</code> or <code>dir</code> 查看当前目录下的文件</li>
<li><code>rm file</code> 删除文件</li>
</ul>
<ol style="list-style-type: decimal">
<li>创建版本库</li>
</ol>
<p>版本库，即仓库，Repository，简单可理解成目录。该目录可以被Git管理，每个文件的修改、删除，都可被Git跟踪，以便未来恢复到变动之前的版本。</p>
<p><code>git init</code> 即建库。（自动生成了一个隐藏文件 <code>.git</code>）</p>
<blockquote>
<p>所有的版本控制系统，其实只能跟踪文本文件的改动，比如TXT文件，网页，所有的程序代码等等，Git也不例外。版本控制系统可以告诉你每次的改动，比如在第5行加了一个单词“Linux”，在第8行删了一个单词“Windows”。</p>
<p>不幸的是，Microsoft的Word格式是二进制格式，因此，版本控制系统是没法跟踪Word文件的改动的。如果要真正使用版本控制系统，就要以纯文本方式编写文件。</p>
<p>因为文本是有编码的，如果没有历史遗留问题，强烈建议使用标准的UTF-8编码，所有语言使用同一种编码，既没有冲突，又被所有平台所支持。</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>将文件添加到版本库</li>
</ol>
<p><code>git add readme.txt</code> 添加某一文件；<code>git add .</code> 添加目录下的所有文件。</p>
<p>紧接着提交，<code>git commit -m "wrote a readme file"</code>。这里，<code>-m " "</code> 指的是此次提交的说明，最好是有意义，便于以后在历史记录中找到。</p>
<p>add可多次添加；commit可一次性提交。</p>
<pre class="markdown"><code>git add file1.txt
git add file2.txt file3.txt
git commit -m &quot;add 3 files&quot;</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>修改文件</li>
</ol>
<p>修改readme.txt文件后，可用<code>git status</code>查看仓库当前的状态。命令提示该文件被修改过。</p>
<p><code>git diff readme.txt</code> 可输出修改前后的差异。<code>git diff HEAD -- readme.txt</code> 可以查看版本库中最新版本与工作区文件的区别。</p>
<p>我们提交修改后的文件是，依然是两步，先添加再提交，即add和commit两个命令。</p>
<ol start="4" style="list-style-type: decimal">
<li>退回版本</li>
</ol>
<p>当我们提交过多次后，可用<code>git log</code>查看历史记录</p>
<ul>
<li><p>退回命令为 <code>git reset --hard HEAD^</code>。<br />
注意：<code>HEAD</code>相当于一个指针，可以指向不同的版本。<code>HEAD</code>最新的当前版本，<code>HEAD^</code>指向上一个版本，<code>HEAD^^</code>上上一个，<code>HEAD~10</code>退回10个版本。<br />
&gt; <a href="https://www.liaoxuefeng.com/wiki/896043488029600/897013573512192">出处可见这里</a></p></li>
<li><p>另外可选择的命令是 <code>git reset --hard e475af</code><br />
其中，e475af是版本号（很长一串）的前几位，Git会依此来自动检索并变更版本。</p></li>
<li><p>如果找不到版本号，可用 <code>git reflog</code>，其记录了每一次的命令。</p></li>
</ul>
<p><code>cat readme.txt</code> 可查看变更版本后文件的内容</p>
<p>再理解。</p>
<ul>
<li>项目的目录（总文件夹）为工作区</li>
<li>初始化建库 <code>git init</code> 后，生成了repository仓库，也就是.git文件。
<ul>
<li>stage 暂存区；每次<code>git add</code>都是将新版本文件添加到暂存区</li>
<li>master 分支；而commit则是将暂存区的内容都提交到当前的分支</li>
</ul></li>
</ul>
<ol style="list-style-type: decimal">
<li>我们都是在工作区，新建、编辑和修改文件。</li>
<li>完成内容后，注意此时文件还在工作区。可<code>git status</code>查看状态，比如
<ol style="list-style-type: lower-alpha">
<li>Changes not staged，修改未存到暂存区</li>
<li>Untracked file，文件未被“追踪”</li>
</ol></li>
<li>使用<code>git add</code>命令将新版本文件逐一添加到暂存区</li>
<li>使用<code>git commit -m " "</code>提交到分支，提交完成后，暂存区变空白。</li>
</ol>
<div class="figure">
<img src="images/gitstage.png" alt="" />
<p class="caption">Add file to stage in local repo</p>
</div>
<div class="figure">
<img src="images/gitcommit.png" alt="" />
<p class="caption">Commit all the files in stage area</p>
</div>
<p><strong>到此，本地仓库构建完毕</strong></p>
<ol start="5" style="list-style-type: decimal">
<li>撤销工作区的修改，<code>git checkout -- file</code></li>
</ol>
<ul>
<li>如果我们改乱了文件，且修改的文件未放到暂存区，想丢弃工作区的修改。撤销修改可以回到和版本库一模一样的状态；</li>
<li>如果存到了暂存区，就需要多做一步，先 <code>git reset HEAD readme.txt</code> 把暂存区内容<strong>打回退到工作区</strong>，再<code>git checkout -- file</code> 扔掉修改。</li>
</ul>
<ol start="6" style="list-style-type: decimal">
<li>删除文件</li>
</ol>
<p>我们可以手动删除或<code>rm file</code>删除工作区的文件。但仓库里面的版本还在。如果确要删去仓库中的，先<code>git rm test.txt</code>，再提交<code>git commit -m "remove test file"</code>。</p>
<p>假使该文件是误删，由于仓库里还有该文件，故可以找回。因为删除也是一个修改动作，我们想撤销删除，则运行 <code>git checkout -- test.txt</code>。</p>
<blockquote>
<p>git checkout其实是用版本库里的版本替换工作区的版本，无论工作区是修改还是删除，都可以“一键还原”。</p>
</blockquote>
<ol start="7" style="list-style-type: decimal">
<li>远程仓库</li>
</ol>
<ol style="list-style-type: lower-alpha">
<li>创建SSH Key。（Windows下打开Git Bash<br />
<code>ssh-keygen -t rsa -C "your email"</code> 得到一对秘钥，其中，.pub扩展名是公开秘钥。</li>
<li>Github -&gt; Settings -&gt; SSH and GPG keys -&gt; New SSH key。Title任意，Key一栏填写.pub文件的内容</li>
</ol>
<p>Github托管本地仓库内容，作为一个备份。步骤如下：</p>
<ul>
<li>构建本地库（init, add, commit）</li>
<li>新建Github远程仓库，Create a new repo -&gt; Repo name -&gt; Create repo。（注意把默认分支branch改为master）。复制仓库的SSH链接。<br />
注：Git支持多种协议，包括https，但SSH协议速度最快。</li>
<li>在Git中运行 <code>git remote add origin 复制的SSH</code>，将本地库与远程库关联。</li>
<li>将本地库的所有内容推送到远程库上，<code>git push -u origin master</code>，实际上是把当前分支master推送到远程。<br />
！！！这里注意，新建的远程仓库是空的，第一次推送分支时要加上-u这个参数；等远程仓库有了内容之后，每次本地提交后，就可以使用命令 <code>git push origin master</code>，把本地master分支的<strong>最新修改推送至GitHub</strong>。</li>
</ul>
<blockquote>
<p>-u 参数可以在推送上传的同时，还将远程origin仓库的master分支设置为本地仓库当前分支的upstream（上游），将两个分支关联了起来。添加了这个参数，将来运行git pull命令从远程仓库获取内容时，本地仓库的这个分支就可以直接从远程origin的master分支获取内容，省去了另外添加参数的麻烦。这个参数也只用在第一次push时加上，以后直接运行 git push 命令即可。
<a href="https://blog.csdn.net/ourstronger/article/details/101059246">参见此处</a></p>
</blockquote>
<p><strong>其他远程库相关操作</strong></p>
<p>上面步骤已将本地库与远程库进行了关联 <code>git remote add origin</code>，其中，origin是远程库的默认名称。</p>
<ol style="list-style-type: lower-roman">
<li><p>如果我们想解除关联，建议先使用 <code>git remote -v</code> 查看远程库信息；再根据名字取消关联，如解耦origin，<code>git remote rm origin</code>。</p></li>
<li><p>如果要删除远程库，需要登录到GitHub，在后台页面删除。</p></li>
<li><p>要克隆一个仓库，首先必须知道仓库的地址，然后使用 <code>git clone</code> 命令克隆。</p></li>
</ol>
<ol start="8" style="list-style-type: decimal">
<li>分支管理</li>
</ol>
<p><code>git branch</code> 查看当前分支；<code>git branch dev</code> 创建新的分支dev；</p>
<p><code>git switch dev</code> 切换到dev分支；</p>
<p><code>git switch -c dev</code> 创建并切换到新的分支，dev。</p>
<p><code>git branch -d dev</code> 删除dev分支；</p>
<p>切换到dev分支后，随后所有的修改提交都是提交到dev分支（其时间线越来越长）。当dev分支工作完成后，我们切换到master分支。并使用 <code>git merge dev</code> 将dev的工作成果合并到当前的master分支。注意，该合并直接把master指向了dev的当前提交。也就是滞后、落后版本的master，跳跃（指向）到了dev的最新版本。</p>
</div>
